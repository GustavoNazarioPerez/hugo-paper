<footer
  class="mx-auto flex h-[4.5rem] max-w-(--w) items-center px-8 text-xs tracking-wider uppercase opacity-60"
>
  <div class="mr-auto">
    {{- if site.Copyright -}} 
      {{- site.Copyright -}} 
    {{- else -}} 
      &copy; {{- now.Year }} 
      <a class="link" href="{{- `` | absURL -}}">{{- site.Title -}}</a>
    {{- end -}}
  </div>

  <button 
    class="link mx-6" 
    onclick="document.getElementById('subscribe-modal').style.display='flex'"
  >
    SUBSCRIBE
  </button>

  <a 
    class="link mx-6" 
    href="https://gohugo.io/" 
    rel="noopener" 
    target="_blank"
  >powered by hugoÔ∏èÔ∏è</a>

  <a
    class="link"
    href="https://github.com/nanxiaobei/hugo-paper"
    rel="noopener"
    target="_blank"
  >hugo-paper</a>
</footer>

<!-- Subscribe Modal -->
<div 
  id="subscribe-modal" 
  style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); align-items:center; justify-content:center; z-index:1000;"
  onclick="if(event.target.id==='subscribe-modal') this.style.display='none'"
>
  <div style="background:var(--theme); padding:2rem; border-radius:8px; max-width:400px; width:90%;">
    <h3 style="margin:0 0 1rem 0; text-transform:uppercase; letter-spacing:0.1em;">
      Subscribe for Updates
    </h3>

    <form 
      id="subscribe-form"
      style="display:flex; flex-direction:column; gap:1rem;"
    >
      <input 
        type="email" 
        name="email" 
        placeholder="your@email.com" 
        required
        style="padding:0.75rem; border:1px solid var(--theme); background:var(--theme-bg); border-radius:4px;"
      >
      <div style="display:flex; gap:0.5rem;">
        <button 
          id="subscribe-button"
          type="submit"
          style="flex:1; padding:0.75rem; background:var(--theme); border:1px solid var(--theme); border-radius:4px; cursor:pointer; text-transform:uppercase; letter-spacing:0.1em; font-size:0.75rem;"
        >
          Subscribe
        </button>
        <button 
          type="button"
          onclick="document.getElementById('subscribe-modal').style.display='none'"
          style="flex:1; padding:0.75rem; background:transparent; border:1px solid var(--theme); border-radius:4px; cursor:pointer; text-transform:uppercase; letter-spacing:0.1em; font-size:0.75rem;"
        >
          Cancel
        </button>
      </div>
    </form>

    <p 
      id="subscribe-message" 
      style="display:none; margin-top:1rem; text-align:center; font-size:0.85rem;"
    ></p>
  </div>
</div>

<script>
document.getElementById('subscribe-form').addEventListener('submit', async function(e) {
  e.preventDefault();

  const form = this;
  const email = form.email.value.trim();
  const message = document.getElementById('subscribe-message');
  const button = document.getElementById('subscribe-button');

  message.style.display = 'none';
  message.textContent = '';

  if (!email) return;

  // üîÑ Show loading state
  button.disabled = true;
  const originalText = button.textContent;
  button.textContent = 'Subscribing‚Ä¶';
  button.style.opacity = '0.7';
  button.style.cursor = 'wait';

  try {
    const response = await fetch('https://buttondown.com/api/emails/embed-subscribe/nazario', {
      method: 'POST',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      body: new URLSearchParams({ email })
    });

    if (response.ok) {
      message.textContent = 'üéâ Thanks for subscribing!';
      message.style.color = 'limegreen';
      form.reset();

      // Optional: close modal after a few seconds
      setTimeout(() => {
        document.getElementById('subscribe-modal').style.display = 'none';
        message.style.display = 'none';
      }, 2500);

    } else {
      message.textContent = '‚ö†Ô∏è Something went wrong. Please try again.';
      message.style.color = 'orange';
    }
  } catch (err) {
    message.textContent = '‚ö†Ô∏è Could not connect. Try again later.';
    message.style.color = 'red';
  }

  message.style.display = 'block';

  // ‚úÖ Restore button state
  button.disabled = false;
  button.textContent = originalText;
  button.style.opacity = '1';
  button.style.cursor = 'pointer';
});
</script>

